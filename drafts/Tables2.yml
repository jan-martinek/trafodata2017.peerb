name: Funkce a vzorce mezi daty v tabulkách
goals: |
    Se strukturou seznamu dat jsme se seznámili v minulé lekci. Tento týden se naučíme s daty pracovat a dělat nad nimi výpočty.
    
    Z videa a článku z minulého týdne jste se dozvěděli něco o tom, jak o tabulkovém procesoru uvažovat jako o prostředí k funkcionálnímu programování. Tohoto výrazu se nelekejte, jen je dobré si uvědomit, že i tvorba vlastních vzorečků je forma programování: dáváte počítači instrukce, podle kterých pak bude dělat práci za vás.
reading: |
    V této lekci se naučíme vzorce a funkce používat a kombinovat. Úkoly v této lekci jsou zaměřeny hodně prakticky a všechny vychází z požadavků v reálné praxi.
    
    ### Začínáme
    
    Projděte si tutorial o tvorbě vzorců. Pokud používáte MS Excel, tak doporučuji např. [článek přímo od podpory Microsoftu](https://support.office.com/cs-cz/article/P%C5%99ehled-vzorc%C5%AF-d258ec72-149a-42ac-8eae-b50a667eb491). Pokud používáte jiný tabulkový procesor, tak můžete využít tento úvod také &ndash; psaní vzorců je ve většině tabulkových procesorů velmi podobné. 
    
    ### Funkce
    
    Níže najdete seznam funkcí, které je dobré pro manipulaci s daty v tabulkových procesorech znát. Informace o nich si dohledejte na stránkách zákaznické podpory vašeho tabulkového procesoru, kterou jste našli v rámci předchozího úkolu. 
    
    V různých tabulkových procesorech se mohou stejné funkce jmenovat jinak. V české lokalizaci Excelu se funkce jmenují česky, např. `POČET` místo původního `COUNT`. V Google Spreadsheet jsou funkce nazvané anglicky. Přehled českých a anglických názvů najdete např. v [článku Pavla Lasáka](http://office.lasakovi.com/excel/funkce/ms-excel-funkce-en-cz/).
    
    Seznam funkcí, které se vám budou hodit:
    
    - suma (`SUMA`, `SUM`),
    - počet (`POČET`, `COUNT`),
    - když (`KDYŽ`, `IF`),
    - podmíněná suma (`SUMIF`),
    - podmíněný součet (`COUNTIF`),
    - skalární součin (`SKALÁRNI.SOUČIN`, `SUMPRODUCT`),
    - index (`INDEX`),
    - maximum (`MAX`),
    - minimum (`MIN`),
    - vyhledání hodnoty v matici (`POZVYHLEDAT`, `MATCH`),
    - vyhledat svisle (`SVYHLEDAT`, `VLOOKUP`),
    - najít (`NAJÍT`, `FIND`),
    - délka (`DÉLKA`, `LEN`),
    - pročistit (`PROČISTIT`, `TRIM`),
    - část textu zleva / zprava (`ZLEVA`, `LEFT` / `ZPRAVA`, `RIGHT`),
    - zaokrouhlení (`ZAKROUHLIT`, `ROUND`).
    
    ### Experimentujte
    
    Důležité je i myslet na to, že k jednomu cíli vede několik cest. Takže některé výpočty lze provést pomocí jedné funkce, nebo např. pomocí více různých funkcí. Nebojte si dělat nové sloupečky s pomocnými mezivýpočty.

    ### Importování dat a formát CSV
    
    V úplně prvních lekcích tohoto kurzu jsme se zaobírali tím, jak psát dokumenty v prostém textu (plain text). Podobná možnost existuje i pro tabulky, např. pomocí souboru typu CSV. CSV se používá především pro přenos dat mezi různými aplikacemi, je snadno editovatelný a čitelný i bez speciálního editoru.
    
    Přečtěte si např. [heslo CSV na Wikipedii](https://cs.wikipedia.org/wiki/CSV). 
    
    #### Vizualizace dat
    
    Po formátování by dalším krokem byla např. vizualizace dat: vytváření grafů, infografik, interaktivních nástrojů apod. Na tuto kapitolu už v tomto předmětu není prostor. Pokud by vás lákal i tento směr, tak se podívejte např. na předmět [VIKMB37 Vizualizace dat](https://is.muni.cz/predmet/phil/VIKMB37).
rubrics:
    - 
        metric: "Používá autor/ka zpracovaného úkolu správně a konzistentně termíny, které se týkají práce s tabulkovými daty?"
        0: "V úkolu jsou zcela nesprávně používány základní termíny."
        1: "V úkolu se s termíny pracuje neobratně, ale je vidět určité porozumění."
        2: "Termíny jsou používány správně a konzistentně, ale občas se vyskytují drobné chyby."
        3: "Autor/ka obratně pracuje s termíny. Správně je definuje a v úkolu je používá konzistentně."
    - 
        metric: "Jsou všechny výpočty v tabulkách provedeny správně? Popište, které jsou nedostatečné? Doporučte autorce/autorovi zdroje pro doplnění znalostí."
        0: "Výsledky opakovaně obsahují zásadní chyby, nebo zcely chybí, popř. jsou výsledky zapsány ručně."
        1: "Část výpočtů je dobře, ale některá úloha obsahuje zásadní chybu. Popř. se v úlohách opakuje množství drobných chyb."
        2: "Téměř všechny výsledků jsou správné, občase se objevují drobné nedostatky, které lze jednoduše opravit."
        3: "Výsledky výpočtů jsou správné."
    - 
        metric: "Robustnost výpočtů — fungují výpočty správně i po změně vstupních dat?"
        0: "Autor/ka opakovaně používá vzorce, které fungují pouze se zadanými daty. Popř. vzroce úplně chybí."
        1: "Výsledky výpočtů jsou často v pořádku, ale některé vzorce fungují jen se zadanými daty."
        2: "Výsledky výpočtů jsou vetšinou v pořádku i po změně vstupních dat, objevují se pouze drobné problémy."
        3: "Výsledky všech výpočtů jsou v pořádku i po změně vstupních dat."
    - 
        metric: "Podařilo se autorovi/ce nalézt a popsat využití datasetu?"
        0: "Úkol nebyl řešen, popř. byl odevzdán pouze dataset."
        1: "Byl nalezen dataset, v popisu dat a jejich využití se objevují nedostatky. Popř. v odevzdaném souboru jsou zásadní chyby."
        2: "Byl nalezen dataset, jsou dobře popsaná data a jejich možné využití. V odevzdaném souboru se vyskytují drobné chyby."
        3: "Byl nalezen dataset, správně zpracován, odevzdán a dostatečně popsáno jeho využítí."
preface: |
    Dejte si pozor na správné užívání pojmů.
    
    V případě potřeby můžete odevzdávaný soubor zazipovat, ale nemělo by to být nutné. **Důležité je najít správný výsledek a využít přitom vhodné funkce — ne to, jak výsledek vypadá.**
    
    Sdílený soubor s podklady najdete [zde](https://goo.gl/n2blnx). **Tip:** můžete si jej stáhnout celý (nebo si vytvořit vlastní kopii) a pracovat přímo v něm.
---
bloom: analyze
count: 2
allowRepeat: question
vars:
    fn: [SUMIF, COUNTIF, SUMPRODUCT, VLOOKUP, FIND, TRIM, INDEX, FLOOR, CEILING, MATCH]
questions: "Popište funkci `%fn%`. Jaké má parametry a k čemu byste ji použili?"
---
bloom: remember
questions:
    - "Co znamená symbol dolar (`$`) před zápisem buňky ve vzorci? Např. `=A1 + $D$1`. Jak byste tuto možnost využili?"
---
bloom: remember
count: 2
questions:
    - "Co znamená zkratka CSV v kontextu tabulkových souborů?"
    - "Jaký je rozdíl mezi soubory typu XLSX a CSV?"
---
bloom: create
input: file
comments: 5
questions: |
    Ze [sdíleného souboru](https://goo.gl/n2blnx) si do tabulkového procesoru zkopírujte list “Klasifikační arch ZŠ”. Do sloupce “Vážený průměr” vypočítejte pro každého studenta vážený průměr (2 desetinná místa). Do sloupce navržená známka pak zaokrouhlete vážený průměr na nejbližší celé číslo. Použijte vzorce tak, aby když se změní zadaná hodnota známky nebo váha, tak se automaticky přepočítá i vážený průměr a navržená známka. Soubor uložte ve formátu XLSX a odevzdejte.
    
    Postup stručně popište a vypište funkce, které jste použili.
    
    *Jména a známky jsou smyšlené.*
    
    Pokud nevíte, jak se počítá vážený průměr, poradí Vám [např. Wikipedie](https://cs.wikipedia.org/wiki/V%C3%A1%C5%BEen%C3%BD_pr%C5%AFm%C4%9Br).
---
bloom: create
input: file
comments: 5
questions: |
    Ze [sdíleného souboru](https://goo.gl/n2blnx) si do tabulkového procesoru zkopírujte list “Akcie”. Do sloupce “Hodnota (Kč)” vypočítejte hodnotu akcií podle kurzu v tabulce vlevo. Do políčka “Celkem” pak hodnotu celého portfolia. Všechny hodnoty upravte na 2 desetinná místa (pomocí formátování). Soubor uložte ve formátu XLSX a odevzdejte.
    
    Použijte vzorce tak, aby se automaticky přepočítala hodnota portfolia a jeho položek, když se změní počet akcií, stav kurzu nebo název společnosti v portfoliu.
    
    Použijte funkci `SVYHLEDAT` (v angličtině `VLOOKUP`). Postup stručně popište a vypište funkce, které jste použili.
            
    *Jedná se o skutečný kurzovní lístek. Portfolio je smyšlené.*
---
bloom: create
input: file
comments: 5
questions: |
    Ze [sdíleného souboru](https://goo.gl/n2blnx) si do tabulkového procesoru zkopírujte list „Seznam zaměstnanců“.
    
    Pomocí vzorců vypočítejte hodnoty:
        
    - Počet neproškolených BZOP,
    - Celková prémie pro knihovníky,
    - Průměrná prémie pro knihovníky,
    - Příjmení zaměstnance s nejvyšší prémií.
            
    Použijte vzorce tak, aby když se změní pozice, informace o proškolení nebo výše prémie, tak se hodnoty automaticky přepočítají. Hodnoty o prémiích naformátujte na 2 desetinná místa + symbol „Kč“. Soubor uložte ve formátu XLSX a odevzdejte.
            
    Postup stručně popište a vypište funkce, které jste použili.
            
    *Instituce a jména jsou smyšlená.*
---
bloom: analyze
input: file
comments: 8
questions: |
    Na serveru [datahub.io](http://datahub.io) najděte dataset (tabulkový soubor s daty), který je ve formátu CSV a přijde vám zajímavý. CSV soubor otevřete popř. z něj importujte data do tabulkového procesoru tak, aby hodnoty byly v samostatných buňkách. Soubor uložte ve formátu XLSX a odevzdejte.
    
    Pokud bude příliš velký, zkraťte ho na prvních 1000 řádků.
    
    Do komentáře vložte odkaz na původní CSV soubor. Stručně popište postup, proč jste si vybrali tento soubor a jak by se s ním dalo dále pracovat, k čemu by se data dala použít apod. Samotné zamyšlení nad významem a použití dat je v této úloze důležitější, než odevzdání souboru (doporučená délka popisu dat a jejich využití je 0,5—1 NS).
